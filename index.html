<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skaner QR</title>
    <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
</head>
<body>
    <h1>Skaner QR</h1>

    <!-- Ekrany aplikacji -->
    <div id="screen-qr-scan" style="display: block;">
        <h2>Skanuj kod QR</h2>
        <div id="qr-reader" style="width: 300px;"></div>
    </div>

    <div id="screen-login" style="display: none;">
        <h2>Logowanie</h2>
        <form id="login-form">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" value="Jas Fosola"><br>
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" value="PrzykladoweHaslo"><br>
            <button type="button" onclick="startSecondScan()">Przejdź do drugiego skanowania</button>
        </form>
    </div>

    <div id="screen-send" style="display: none;">
        <h2>Gotowe</h2>
        <button onclick="alert('Wysłano!')">SEND</button>
    </div>

    <script>
        function onScanSuccess(decodedText, decodedResult) {
            console.log("Kod QR zeskanowany: " + decodedText);
            alert("Kod QR zeskanowany: " + decodedText);

            // Przejście do ekranu logowania
            document.getElementById("screen-qr-scan").style.display = "none";
            document.getElementById("screen-login").style.display = "block";
        }

        function startScanner() {
            let qrReader = new Html5Qrcode("qr-reader");
            qrReader.start(
                { facingMode: "environment" },
                { fps: 10, qrbox: { width: 250, height: 250 } },
                onScanSuccess
            ).catch(err => {
                console.error("Błąd podczas uruchamiania skanera: ", err);
            });
        }

        function startSecondScan() {
            document.getElementById("screen-login").style.display = "none";
            document.getElementById("screen-qr-scan").style.display = "block";

            let qrReader = new Html5Qrcode("qr-reader");
            qrReader.start(
                { facingMode: "environment" },
                { fps: 10, qrbox: { width: 250, height: 250 } },
                function(decodedText, decodedResult) {
                    console.log("Drugi kod QR zeskanowany: " + decodedText);
                    alert("Drugi kod QR zeskanowany: " + decodedText);

                    // Przejście do ekranu SEND
                    document.getElementById("screen-qr-scan").style.display = "none";
                    document.getElementById("screen-send").style.display = "block";
                }
            ).catch(err => {
                console.error("Błąd podczas uruchamiania skanera: ", err);
            });
        }

        window.addEventListener("load", startScanner);
    </script>
</body>
</html>
